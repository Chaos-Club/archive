"use strict";(()=>{var m={name:"Koch Curve",angle:Math.PI/3,axiom:"F++F++F",rules:{F:"F-F++F-F"}},c=document.createElement("canvas");c.style.cssText="position:absolute;left:0;top:0;cursor:pointer;";document.body.appendChild(c);var u=c.getContext("2d"),g=document.createElement("div");g.style.cssText=["position:fixed","top:20px","left:20px","color:#999","font:13px/1.7 monospace","pointer-events:none","user-select:none","white-space:pre"].join(";");document.body.appendChild(g);var b=document.createElement("div");b.style.cssText=["position:fixed","bottom:22px","left:50%","transform:translateX(-50%)","color:#555","font:13px/1 monospace","pointer-events:none","user-select:none","white-space:nowrap"].join(";");document.body.appendChild(b);var f=0,x=m.axiom,I=3e5;function F(n,t){let i="";for(let e of n)i+=t[e]??e;return i}function $(n,t,i){let e=[],h=[],r=0,a=0,s=0;for(let d of n)switch(d){case"F":case"G":e.push({x:r,y:a,move:!0}),r+=t*Math.cos(s),a+=t*Math.sin(s),e.push({x:r,y:a,move:!1});break;case"f":r+=t*Math.cos(s),a+=t*Math.sin(s);break;case"+":s-=i;break;case"-":s+=i;break;case"[":h.push({x:r,y:a,a:s});break;case"]":({x:r,y:a,a:s}=h.pop());break}return e}function y(){let n=c.width,t=c.height,i=56;u.clearRect(0,0,n,t);let e=$(x,1,m.angle);if(e.length===0)return;let h=1/0,r=1/0,a=-1/0,s=-1/0;for(let o of e)o.x<h&&(h=o.x),o.x>a&&(a=o.x),o.y<r&&(r=o.y),o.y>s&&(s=o.y);let d=a-h||1,w=s-r||1,l=Math.min((n-i*2)/d,(t-i*2)/w),v=(n-d*l)/2-h*l,M=(t-w*l)/2-r*l;u.beginPath();for(let o=0;o<e.length-1;o++){let p=e[o],k=e[o+1];p.move&&(u.moveTo(p.x*l+v,p.y*l+M),u.lineTo(k.x*l+v,k.y*l+M))}u.strokeStyle="#5cf",u.lineWidth=Math.max(.4,2/Math.pow(3,f/2)),u.stroke(),S()}function P(n){let t=[[Math.PI/6,"\u03C0/6"],[Math.PI/4,"\u03C0/4"],[Math.PI/3,"\u03C0/3"],[Math.PI/2,"\u03C0/2"],[2*Math.PI/3,"2\u03C0/3"],[Math.PI,"\u03C0"]];for(let[i,e]of t)if(Math.abs(n-i)<1e-9)return e;return n.toFixed(4)+" rad"}function S(){let n=Object.entries(m.rules).map(([i,e])=>`  ${i} \u2192 ${e}`).join(`
`);g.textContent=`${m.name}
${"\u2500".repeat(22)}
iteration  ${f}
angle      ${P(m.angle)}
axiom      ${m.axiom}

rules:
${n}`;let t=F(x,m.rules).length;b.textContent=t<=I?`click \u2192 iteration ${f+1}`:"maximum expansion reached"}c.addEventListener("click",()=>{let n=F(x,m.rules);n.length>I||(f++,x=n,y())});window.addEventListener("resize",()=>{c.width=window.innerWidth,c.height=window.innerHeight,y()});c.width=window.innerWidth;c.height=window.innerHeight;y();})();
